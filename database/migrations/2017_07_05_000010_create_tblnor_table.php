<?php// use Illuminate\Support\Facades\Schema;// use Illuminate\Database\Schema\Blueprint;// use Illuminate\Database\Migrations\Migration;use App\Console\BaseMigrations;class CreateTBLNORTable extends BaseMigrations{    /**     * Run the migrations.     *     * @return void     */    public function up()    {        Schema::dropIfExists('TBLNOR');        Schema::create('TBLNOR', function ($table) {            $table->increments('TNNOMRIY')->nullable(false)->comment('NoUrut IY');            $table->char('TNTABL',50)->nullable(false)->comment('Nama Tabel');            $table->char('TNNOUR',100)->nullable(false)->comment('No Terakhir');            $this->AutoCreateKolom('TN', $table);            $table->unique('TNTABL');                   });                 // DB::unprepared('        //     if exists (select 1        //               from sysobjects        //               where  id = object_id(\'StpTBLNOR\')        //               and type in (\'P\',\'PC\'))        //        drop procedure StpTBLNOR');        // DB::unprepared('        //     create procedure [dbo].[StpTBLNOR] (        //       @USERNAME As VarChar(50),        //       @TNTABL As VarChar(10)        //      )                      //      WITH EXECUTE as        //     CALLER         //     AS        //     Declare @SQLSTM  As NVarChar(Max)        //     Declare @NoUrut As Dec(20,0)        //        Set @NoUrut = IsNull( ( Select TNNOUR From TBLNOR Where TNTABL = @TNTABL ), 0)        //        IF ( @NoUrut = 0 ) Begin        //            Set @NoUrut = 1        //            BEGIN TRY                //                SET @SQLSTM = \'\'        //                SET @SQLSTM = @SQLSTM + \'  INSERT INTO TBLNOR ( TNTABL, TNNOUR \'        //                SET @SQLSTM = @SQLSTM + \' ) VALUES (\'        //                SET @SQLSTM = @SQLSTM + \'  \'\'\' + @TNTABL + \'\'\', \'\'1\'\' \'        //                SET @SQLSTM = @SQLSTM + \' ) \'        //                EXEC Sp_ExecuteSql @SQLSTM;        //                EXEC [dbo].[StpTBLSLF] @USERNAME,@SQLSTM;        //            END     TRY        //            BEGIN CATCH        //                SET @SQLSTM = @SQLSTM+\' Insert \'+ERROR_MESSAGE()        //                RAISERROR(@SQLSTM,16,1)        //            END CATCH               //        End Else Begin        //            Set @NoUrut = @NoUrut+1;        //            BEGIN TRY                //                SET @SQLSTM = \'\'        //                SET @SQLSTM = @SQLSTM + \'  UpDate TBLNOR Set TNNOUR = IsNull(TNNOUR,0)+1 \'        //                SET @SQLSTM = @SQLSTM + \'  Where TNTABL = \'\'\' + @TNTABL + \'\'\' \'        //                EXEC Sp_ExecuteSql @SQLSTM;        //                EXEC [dbo].[StpTBLSLF] @USERNAME,@SQLSTM;        //            END     TRY                                                  //            BEGIN CATCH                                                  //                SET @SQLSTM = @SQLSTM+\' Insert \'+ERROR_MESSAGE()                                                 //                RAISERROR(@SQLSTM,16,1)                                                  //            END CATCH               //        End        //        Return @NoUrut        //     ');    }     /**      * Reverse the migrations.      *      * @return void      */     public function down()     {         Schema::dropIfExists('TBLNOR');     } } ?> 